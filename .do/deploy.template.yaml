spec:
  name: nextjs-guestbook-app
  region: blr1
  services:
    - name: web
      environment_slug: node-js
      source_dir: ./
      github:
        repo: Haimantika/Nextjs-AppPlatform
        branch: main
        deploy_on_push: true
      build_command: "npm install && npm run build"
      run_command: "npm start"
      http_port: 3000
      instance_count: 1
      instance_size_slug: basic-xxs
      routes:
        - path: /
      envs:
        - key: NODE_ENV
          value: production
        - key: DATABASE_URL
          value: "${guestbook-db.DATABASE_URL}"
          type: SECRET
  databases:
    - name: guestbook-db
      engine: PG
      version: "15"
      production: false
  alerts:
    - rule: DEPLOYMENT_FAILED
    - rule: DOMAIN_FAILED
  features:
    - buildpack-stack=ubuntu-22
